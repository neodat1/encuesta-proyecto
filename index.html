<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Encuesta</title>
</head>
<body>
    <h1>Encuesta</h1>
    <form id="formulario">
        <label>Nombre: <input type="text" name="nombre" required></label><br><br>
        <label>Edad: <input type="number" name="edad" required></label><br><br>
        <button type="submit">Enviar</button>
    </form>
    <script>
      document.getElementById('formulario').addEventListener('submit', async function(e) {
        e.preventDefault();
        const datos = {
          nombre: this.nombre.value,
          edad: this.edad.value,
          fecha: new Date().toISOString()
        };
        const title = `Nueva respuesta de ${datos.nombre}`;
        const body = JSON.stringify(datos, null, 2);

        const repo = "neodat1/encuesta-proyecto";
        const url = `https://api.github.com/repos/${repo}/issues`;
        // Aquí no hay token. Si quiere hacer pruebas como usuario autenticado, use un token solo en local.

        await fetch(url, {
          method: "POST",
          headers: {
            "Accept": "application/vnd.github.v3+json"
            // Si desea probar como dueño del repo, agregue: , "Authorization": "token SU_TOKEN"
          },
          body: JSON.stringify({title, body})
        })
        .then(res => {
            if(res.ok) alert("¡Respuesta enviada! Se guardará en unos segundos.");
            else alert("Error enviando respuesta (verifique que los issues están habilitados)");
        });
      });
    </script>
</body>
</html>
